[toc]

### **1.什么是protobuf以及为何要使用protobuf**

protocol buffer是由google推出一种数据编码格式，不依赖平台和语言。

和json或者xml相比，protocol buffer的解析速度更快，编码后的字节数更少。

用于 对结构数据进行序列化的工具，从而实现 数据存储和交换。

（主要用于网络通信中 收发两端进行消息交互。所谓的“结构数据”是指类似于struct结构体的数据，可用于表示一个网络消息）

序列化： 将结构数据或者对象转换成能够用于存储和传输的格式。

反序列化： 在其他的计算环境中，将序列化后的数据还原为数据结构和对象。

从“序列化”字面上的理解，似乎使用C语言中的struct结构体就可以实现序列化的功能：将结构数据填充到定义好的结构体中的对应字段即可，接收方再对结构体进行解析。

在单机的不同进程间通信时，使用struct结构体这种方法实现“序列化”和“反序列化”的功能问题不大，但是，在网络编程中，即面向网络中不同主机间的通信时，则不能使用struct结构体，原因在于：

（1）**跨语言平台**，例如发送方是用C语言编写的程序，接收方是用Java语言编写的程序，不同语言的struct结构体定义方式不同，不能直接解析；

（2）struct结构体存在 **内存对齐** 和 CPU不兼容的问题。

因此，在网络编程中，实现“序列化”和“反序列化”功能需要使用通用的组件，如 Json、XML、protobuf 等。

### **2.如何使用protobuf**

首先我们需要下载一个google提供的编译器，下载地址：

https://github.com/protocolbuffers/protobuf/releases/tag/v3.12.1

选择自己的系统下载相应的zip包.

解压后就能看到看到一个protoc的执行文件，即是我们所需要的编译器。

接着我们需要定义一份BasicUsage.proto的描述文件，其结构和我们定义普通的类十分类似。**特别需要注意的是，字段后跟着的=号不代表字段的值，而是字段的序号**，后面会详细解释

 
